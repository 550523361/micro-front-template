# 微前端架构模板

## 介绍

> 微前端是一种类似于微服务的架构，它将微服务的理念应用于浏览器端，即将单页面前端应用由单一的单体应用转变为多个小型前端应用聚合为一的应用。各个前端应用还可以独立开发、独立部署。同时，它们也可以在共享组件的同时进行并行开发——这些组件可以通过 NPM 或者 Git Tag、Git Submodule 来管理。

为实现多个独立应用（功能独立，业务耦合度高）之间无缝切换，借鉴了蚂蚁金服的微前端架构方案，将多个应用聚合在一起。通过自定义配置，实现不同应用之间页面级别的自由组合，搭建了这套微前端架构模板。（如下图）


![架构图](http://shadows-mall.oss-cn-shenzhen.aliyuncs.com/images/blogs/micro-front/1.png)

效果图：

![效果图](http://shadows-mall.oss-cn-shenzhen.aliyuncs.com/images/blogs/micro-front/2.png)

## 优点

1. 子应用完全独立，可作为单独的应用使用也可以作为子应用使用，父子应用之间完全解耦，子应用之间互为“黑盒”。
2. 由于子应用完全独立，所以子应用可单独发布。子应用完全可以独立更新发布新版本，对其他应用无依赖，更不需要全部重新打包发布。
3. 支持异构，由于子应用完全独立的特性，子应用可自由选择技术栈（如 react、vue、angular、jquery），对于子应用的集成也可前后兼容。
4. 支持共载，支持两个子应用同时显示（由于路由的限制，只支持预设置路由的 SPA 页面、预渲染或服务端渲染的页面）。
5. 支持全局状态同步管理，主应用集成了 `redux` 作为状态中心，子应用可以共享并操作该状态中心，达到同步状态的目的。
6. 支持子应用路由懒加载，优化资源加载机制。
7. 粒度够细，可通过配置项灵活组装拆卸需要装载的子应用，比如对于不同需求的客户组装对应的子应用组合（如 AB，ABC，CD 组合就是三个不同的应用）。

## 缺点

1. 对于公共库提取加载的支持较弱，可能会加载重复资源（如 `axios`）。这是因为子应用相对独立，如果提取公共库加载也会导致应用之间耦合性加强，属于一个 `trade off` 点（不影响公共库的使用，这里提的点只是加载）。
2. 对共载的页面不支持路由跳转，因为子应用共享父应用的路由，所以共载的页面无法跳转路由（只能考虑使用路由内切换状态的方式切换显示内容）。
3. 对 MPA 页面支持度较低，具体体现在需要在父应用单独再配置一套路由（无其他限制）。

## 展望

1. 配置 CDN 加速，对子应用资源的加载进行提速。
2. 集成 PWA（Progressive Web Application），实现离线应用，也可以大大提升加载速度，一定程度上解决公共库提取的问题。
3. 实现顶部 `tab` 页记录页面访问记录，保存页面访问状态，实现类似于浏览器标签页的效果。